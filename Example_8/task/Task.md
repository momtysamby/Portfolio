### Содержание
- [Задание](#задание)
  - [Что нужно сделать](#что-нужно-сделать)
    - [Где делать](#где-делать)
    - [Дополнительно](#дополнительно)
  - [Рассказ разработчика](#рассказ-разработчика)
    - [Сущности](#сущности)
  - [Взаимодействие с сервисом](#взаимодействие-с-сервисом)
  - [Доработки](#доработки)

# Задание

Представь, что ты — аналитик-документатор в команде инфраструктурной разработки. Это означает, что команда делает сервисы для других команд внутри компании. Пользователи сервисов и документации — другие разработчики и аналитики. 

Команда разработала сервис сотрудников Employee. Это внутренний сервис, который поможет централизованно работать командам разработки внутри продукта с данными пользователя. Коллеги ждут понятную документацию: они хотят разобраться в схеме работы Employee сервиса и узнать, какие методы есть в клиенте. 

## Что нужно сделать

Твоя задача — создать документацию для коллег.

Разработчик сервиса рассказал тебе, как работает Employee. Его рассказ представлен ниже. Тебе необходимо разобраться в сумбурном потоке мысли разработчика и сделать всё, чтобы документация получилась простой и наглядной. 

Перепиши рассказ разработчика в документацию для пользователя. Она должна быть написана понятным языком, структурирована, аккуратно оформлена.

По ходу чтения тебе будет не хватать информации, зафиксируй вопросы к разработчику. Если чего-то не понимаешь — спроси. Задавать вопросы не стыдно. Стыдно сделать вид, что разобрался, и чувствовать, что ничего на самом деле не понял.

### Где делать

В компании документация лежит на внутренней wiki и представляет собой одну/несколько страниц, при необходимости со схемами и иллюстрациями. Ты можешь сделать задание в гугл-доке, файле Word, на wiki в github или выбрать любой другой удобный инструмент.

### Дополнительно

Чтобы описать методы клиента и различные сущности более качественно, придется заглянуть [в код](https://github.com/NatBur444/task-for-technical-writer). Но если совсем не понимаешь, как это делать, не делай. Попробуй просто по рассказу описать схему работы.

## Рассказ разработчика

Сервис сотрудников это WebAPI-приложение. Он позволяет работать с реквизитами сотрудников организации. Ну то есть он хранит, из него можно читать и редактировать данные по сотрудникам. Также другие сервисы могут в любой момент времени обратиться к реквизитам сотрудников.

Вообще, сотрудники нужны для указания в Реквизитах Плательщика, которые тянутся в отчет пользователя. Начнем с того, что у пользователя могут быть заведены несколько организаций, возможно десятки или сотни. Для каждой Org хранились данные о каждом сотруднике. Если сотрудник относится не к одной огрганизации, то данные дублировались. 

Соответственно если пользователю необходимо поменять данные о сотруднике он должен был зати и поменять данные во всех организациях, к которым относился сотрудник. 

При работе одного или нескольких пользователей с одной организацией, каждому пользователю приходится вводить одни и те же реквизиты организации хотя бы по одному разу, если эти пользователи работают в нескольких продуктах, то они вынуждены вводить реквизиты для той же организации в обоих сервисах, при этом изменение реквизитов в одном сервисе не влечет за собой изменения данных реквизитов в другом сервисе, из-за этого происходят разного рода проблемы на стыке нескольких сервисов.

Сейчас для решений данной проблемы был разработан сервис сотрудников. 

### Сущности

Сущности, хранимые в сервисе сотрудников, используются для формирования отчетов и СОПа. Все сущности привязаны к пользователю и общие для всех организаций данного пользователя. Между пользователями сущности не шарятся.

Имеются следующие сущности:

1. Сотрудник (Person, Employee) - человек. Идентифицируется по guid. Перечень и формат полей см. в PersonProps.cs и Person.cs Данные хранятся таблице в employee.persons.
2. Должность (Position) - данные о сотруднике в конкретной организации (название должности). Данные хранятся в таблице employee.positions
   1. Ключ: guid1 сотрудника + guid2 организации.
   2. Значение: документ, в котором есть только одно строковое поле Title (название должности сотрудника с guid1 в организации с guid2). Один Person может иметь только одну должность внутри одной организации.
3. Роль (Role) - данные о том, какую задачу сотрудник с должностью в одной организации выполняет в какой-нибудь организации (возможно той же) . Т.е. это привязка пары сотрудник-организация к паре организация-тип_роли (Например, Иванов-Директор_головы - это отправитель в головной организации  или Иванов-Разнорабочий_Дочки - это отправитель в дочерней организации; или Петров-Директор_Дочки - это  руководитель в дочке). Данные хранятся в таблице employee.roles.
   1. Типы роли перечислены в RoleType.cs. Всего 4 типа роли: Руководитель, Главный бухгалтер, Уполномоченный представитель (отправитель), индивидуальный предприниматель. 
   2. Ключ: guid2 организации + тип роли (руководитель, главный бухгалтер, отправитель, ИП).
   3. Значение: документ, в котором есть 2 поля:
   Person - guid1 сотрудника с ролью в ключе в организации с guid2
   PositionOrganization - guid3 организации, в которой работает человек c guid1, выполняя роль в организации guid2. guid3 может совпадать с guid2. Роль в организации может выполнять как сотрудник данной организации, так и сотрудник другой организации. Например есть организация с guid3, guid2 - её дочка, где отправитель это сотрудник guid1 c должностью "директор" в guid3.

## Взаимодействие с сервисом

С сервисом можно взаимодействовать через клиента и REST API. Методы собственно позволяют получать, изменять сущности.

## Доработки

В клиенте мы сделали несколько доработок:
1. Сделали метод создания сотрудника идемпотентным. Добавили в url Person (который генерируется на клиенте): вместо POST /person -> PUT /person/{PersonId}.
2. Добавили симметричный созданию метод удаления DELETE
3. Помимо методов создания и получения сотрудника по идентификатору, добавили сложные перекрестые методы получения списка сотрудников, которые создал пользователь, получения списка ролей сотрудника.
4. В методах для должности и роли сразу запроектировали методы таким же образом, как в 1. В остальном для должности нет каких-то сложных методов.
5. Для Роли сделали несколько поисков: первый  можно посмотреть все роли в одной организации. Еще можно получить все роли в пользователе, тогда они вернутся в разрезе организаций. В возвращаемых параметрах giud - это идентификатор организации.
6. Добавили симметричный созданию роли метод удаления DELETE. А также, чтобы не нагружать сервис, сделали метод удаления всех ролей.
